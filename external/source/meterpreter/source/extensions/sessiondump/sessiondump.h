#ifndef _METERPRETER_SOURCE_EXTENSION_SESSIONDUMP_SESSIONDUMP_H

#include "core.h"

#define _METERPRETER_SOURCE_EXTENSION_SESSIONDUMP_SESSIONDUMP_H
#define TLV_TYPE_EXTENSION_SESSIONDUMP	0

// Error codes to communicate with Meterpreter when something fail
#define ERROR_SESSIONDUMP_PROCESS 1
#define ERROR_SESSIONDUMP_GET_DATA_IN_MEMORY 2
#define ERROR_SESSIONDUMP_GET_HASHES 3
#define ERROR_SESSIONDUMP_GET_WDIGEST_PASSWORDS 4

#define TLV_TYPE_ERROR							\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_UINT,				\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 1)

#define TLV_TYPE_VERSION_DLL_REQUEST			\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,			\
				TLV_TYPE_EXTENSION_SESSIONDUMP, \
				TLV_EXTENSIONS + 2)

#define TLV_TYPE_VERSION_DLL_ANSWER				\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,			\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 3)

#define TLV_TYPE_SYMBOLS_NAME					\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,			\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 4)

#define TLV_TYPE_SYMBOLS_ADDR					\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_RAW,			\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 5)

#define TLV_TYPE_DOMAIN							\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,			\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 6)

#define TLV_TYPE_USER							\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,			\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 7)

#define TLV_TYPE_PWD						\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,				\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 8)

#define TLV_TYPE_LM						\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,				\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 9)

#define TLV_TYPE_NTLM						\
		MAKE_CUSTOM_TLV(						\
				TLV_META_TYPE_STRING,				\
				TLV_TYPE_EXTENSION_SESSIONDUMP,	\
				TLV_EXTENSIONS + 10)

#endif
