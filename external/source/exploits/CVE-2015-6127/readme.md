# CVE-2015-6127 File Generation Documentation

This documentation explains how the recordset file and the cab files are generated for the
CVE-2015-6127 exploit.

## The recordset Directory

The recordset file is needed so that when the exploit uses the ADODB.Recordset API, it can properly
download, open, and save our file.

* recordsetdata.txt

This is the file that will be used as an HTA file. Make sure there's no quote around the src
attribute, otherwise that will get mangled by the ADODB.Recordset API.

* generator.hta

You must run this file under Windows, and that will convert recordsetdata.txt into a recordset
file (named recordset.txt).

## The cab Directory

The cab archive is used to host our malicious INF file, which contains instructions about how to
execute our payload.

* create_cab.bat

This script will generate our cab file for us including the INF file. For best results, you should
rebuild one with a signed one.

You can also [click here](https://msdn.microsoft.com/en-us/library/aa751974(v=vs.85).aspx#CABARC) to learn about packaging ActiveX controls.

* msf.inf

This contains instructions on how to execute our payload.