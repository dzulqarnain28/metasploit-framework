typedef struct
{
	UINT	cbSize;
	DWORD	dwFlags;
	DWORD	dwID;
	HWND	hwndTarget;
	POINTS	ptsLocation;
	DWORD	dwInstanceID;
	ULONG_PTR	arbitraryFree;
	ULONG_PTR   ulArguments;
	UINT	cbExtraArgs;
} EXTGESTUREINFO, *PEXTGESTUREINFO;

typedef struct
{
	DWORD fill;
	DWORD flags;
	DWORD numEntries;
	DWORD fill2;
	ULONG_PTR fill3[7];
	DWORD fill4;
	DWORD FunctionPtrLow;
	DWORD FunctionPtrHigh;
	DWORD fill5;
	ULONG_PTR fill6[2];
	DWORD fill7;
	DWORD PalEntriesPtrLow;
	DWORD PalEntriesPtrHigh;
	DWORD SelfRefPtrLow;
	DWORD SelfRefPtrHigh;
	BYTE  colors[360];
} FAKEPALETTE, *PFAKEPALETTE;


typedef struct _RTL_PROCESS_MODULE_INFORMATION
{
	HANDLE Section;
	PVOID MappedBase;
	PVOID ImageBase;
	ULONG ImageSize;
	ULONG Flags;
	USHORT LoadOrderIndex;
	USHORT InitOrderIndex;
	USHORT LoadCount;
	USHORT OffsetToFileName;
	UCHAR FullPathName[256];
} RTL_PROCESS_MODULE_INFORMATION, *PRTL_PROCESS_MODULE_INFORMATION;

typedef struct _RTL_PROCESS_MODULES
{
	ULONG NumberOfModules;
	RTL_PROCESS_MODULE_INFORMATION Modules[1];
} RTL_PROCESS_MODULES, *PRTL_PROCESS_MODULES;

typedef  ULONG(WINAPI * xxxNtQuerySystemInformation)(ULONG, PVOID, ULONG, PULONG);

enum { SystemModuleInformation = 11 };

#define SYSCALL_ARG(x) ((ULONG_PTR)(x))

ULONG(*SystemCall)(ULONG_PTR arg1, ULONG_PTR arg2, ULONG_PTR arg3, ULONG_PTR arg4,
	ULONG_PTR arg5, ULONG_PTR arg6, ULONG_PTR arg7, ULONG_PTR arg8);

ULONG(*NtInjectGesture)(ULONG_PTR arg1, ULONG_PTR arg2, ULONG_PTR arg3, ULONG_PTR arg4,
	ULONG_PTR arg5, ULONG_PTR arg6, ULONG_PTR arg7, ULONG_PTR arg8);

LRESULT CALLBACK GestureProc(HWND, UINT, WPARAM, LPARAM);

ULONG InjectGesture(HWND hwnd, PEXTGESTUREINFO gestureInfo);
