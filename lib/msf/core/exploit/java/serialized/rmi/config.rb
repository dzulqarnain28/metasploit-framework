# -*- coding: binary -*-

module Msf
  module Exploit::Java::Serialized::RMI

    class PropRunConfig < Rex::Java::Serialization::Generator::GeneratorConfig
      def initialize(props)
        @props = props
      end

      def checkRefs?
        @props.fetch('CHECK_REFS')
      end

      def followRemoteRefs?
        @props.fetch('FOLLOW_REMOTE_REFS')
      end

      def tryDeser?
        @props.fetch('TRY_DESER')
      end

      def tryMlet?
        @props.fetch('TRY_MLET')
      end

      def tryClassload?
        @props.fetch('TRY_CLASSLOAD')
      end

      def gadgets
        @props['GADGETS']
      end

      def methodHash
        @props['METHOD_HASH']
      end

      def methodId
        @props['METHOD_ID'] || -1
      end

      def methodSignature
        @props['METHOD_SIGNATURE']
      end
    end
  end
end
