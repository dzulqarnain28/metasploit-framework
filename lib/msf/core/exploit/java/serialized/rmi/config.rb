# -*- coding: binary -*-

module Msf
  module Exploit::Java::Serialized::RMI

    class PropRunConfig < Rex::Java::Serialization::Generator::GeneratorConfig
      def initialize(props)
        @props = props
      end

      def check_refs?
        @props.fetch('CHECK_REFS')
      end

      def follow_remote_refs?
        @props.fetch('FOLLOW_REMOTE_REFS')
      end

      def try_deser?
        @props.fetch('TRY_DESER')
      end

      def try_mlet?
        @props.fetch('TRY_MLET')
      end

      def try_classload?
        @props.fetch('TRY_CLASSLOAD')
      end

      def gadgets
        @props['GADGETS']
      end

      def method_hash
        @props['METHOD_HASH']
      end

      def method_id
        @props['METHOD_ID'] || -1
      end

      def method_signature
        @props['METHOD_SIGNATURE']
      end
    end
  end
end
