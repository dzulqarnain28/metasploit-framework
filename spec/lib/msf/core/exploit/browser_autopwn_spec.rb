require 'spec_helper'
require 'msf/core'
require 'msf/core/exploit/browser_autopwn'

describe Msf::Exploit::Remote::BrowserAutopwn::AutopwnClassMethods do

    include Msf::Exploit::Remote::BrowserAutopwn::AutopwnClassMethods

    describe "#autopwn_info" do
      opts = {
        :ua_name      => 'ua_name',
        :ua_minver    => 'ua_minver',
        :ua_maxver    => 'ua_maxver',
        :ua_ver       => 'ua_ver',
        :classid      => 'classid',
        :method       => 'method',
        :javascript   => 'javascript',
        :os_name      => 'os_name',
        :os_ver       => 'os_ver',
        :postfix_html => 'postfix_html',
        :prefix_html  => 'prefix_html',
        :vuln_test    => 'vuln_test',
        :rank         => 'rank'
      }

      it "should have every specific option configured" do
        autopwn_info(opts)
        autopwn_opts.should eq(opts)
      end
    end
end